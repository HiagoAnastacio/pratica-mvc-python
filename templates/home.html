<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <!-- https://flask.palletsprojects.com/en/stable/tutorial/static/ -->
</head>
<body>
    <h2>Digite a tarefa e data de conclusão:</h2>
    <input id="tarefa" type="text"></input>
    <input id="data" type="date"></input>
    <button onclick="adicionarTarefa()">Adicionar tarefa</button>
    <p id="exibir"></p>
    <div id="lista-de-tarefas"></div>

    <script> // MVC -> Modelagem, visualização, controle
        
        // Seção de Modelagem (de dados)
        let afazeres;
        const afazeresSalvos = JSON.parse(localStorage.getItem('afazeres'));
        if(Array.isArray(afazeresSalvos))
        {
            afazeres = afazeresSalvos;
        }else{
            afazeres = [ // coleção de objetos
                // {
                //     nome: "",
                //     id: ""
                // }
            ];
        }

        function salvarTarefas() { // salva as tarefas no navegador
            localStorage.setItem('afazeres', JSON.stringify(afazeres)); // transforma código em string
        }

        // Seção de Visualização
        function renderizar() {
            
            document.getElementById('lista-de-tarefas').innerHTML = "";
            
            afazeres.forEach(function(tarefa){ // função anônima
                const elemento = document.createElement('div');
                elemento.innerHTML = tarefa.nome + ' - ' + tarefa.dataConclusao;
                
                const botao = document.createElement("button");
                botao.innerText = "Apagar";
                botao.style = "margin-left: 12px;";
                botao.onclick = removerTarefa; // atribui a função a 'onclick' -> sem ()
                botao.id = tarefa.id;
                elemento.appendChild(botao);
                
                const listaDeTarefas = document.getElementById("lista-de-tarefas");
                listaDeTarefas.appendChild(elemento);
            })           
        }

        // Seção de Controle 
        function adicionarTarefa() {
            const caixaDeTexto = document.getElementById("tarefa");
            const caixaData = document.getElementById("data");
            const tarefa = caixaDeTexto.value;
            const data = caixaData.value;
            afazeres.push(
                {
                    nome: tarefa,
                    id: Date.now(),
                    dataConclusao: data,
                }
            );
            
            salvarTarefas();
            renderizar();

            // document.getElementById("exibir").innerHTML = afazeres; -> outra forma de fazer ???
        }

        function removerTarefa(evento){
            const botao = evento.target; // retorna o botão clicado
            const id = botao.id;
            afazeres = afazeres.filter(function(tarefa){
                if(tarefa.id == id){ // compara o id do botão com o id da tarefa
                    return false;
                }else{
                    return true;
                }
            });
            salvarTarefas();
            renderizar();
        }
        renderizar();
    </script>
<!-- <!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <script defer src="agenda2.0.js"></script>
    <link rel="stylesheet" href="static/style.css"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script defer src="agenda2.0.js"></script>
</head>
<body>
    <div class="agenda">
        <h1>Agenda</h1>
        <form class="agenda-form" id="agenda-form">
            <input type="text" id="task-input" placeholder="Adicionar tarefa">
            <div class="date-inputs">
                <input type="number" id="task-day" placeholder="Dia" min="1" max="31">
                <input type="number" id="task-month" placeholder="Mês" min="1" max="12">
                <input type="number" id="task-year" placeholder="Ano" min="1900" max="2100">
            </div>
            <button type="submit">Adicionar</button>
        </form>
        <ul class="agenda-list" id="agenda-list"></ul>
    </div>
    <script>
        let afazeres;
        let afazeresSalvos = JSON.parse(localStorage.getItem("afazeres"));
        if (Array.isArray(afazeresSalvos)) {
            afazeres = afazeresSalvos;
        } else {
            afazeres = [];
        }
    
        function salvarTarefas() {
            localStorage.setItem("afazeres", JSON.stringify(afazeres));
        }
    
        function adicionarTarefa() {
            const caixaDeTexto = document.getElementById("tarefa");
            const dataSelecionada = document.getElementById("data");
            const tarefa = caixaDeTexto.value;
            const data = dataSelecionada.value;
        
            // Verifica se a tarefa e a data foram preenchidas
            if (tarefa && data) {
                afazeres.push({
                    nome: tarefa,
                    id: Date.now(),
                    data: data
                });
    
                // Limpa os campos após adicionar a tarefa
                caixaDeTexto.value = "";
                dataSelecionada.value = "";
    
                renderizar();
                salvarTarefas();
            } else {
                alert("Por favor, preencha a tarefa e a data.");
            }
        }
    
        function renderizar() {
            document.getElementById("lista-de-tarefas").innerHTML = "";
    
            afazeres.forEach(function(tarefa) {
                const botao = document.createElement("button");
                botao.innerText = "Apagar";
                botao.id = tarefa.id;
                botao.onclick = removerTarefa;
    
                const elemento = document.createElement("div");
                elemento.classList.add("tarefa");
                elemento.innerHTML = `${tarefa.nome} <strong>Data: ${tarefa.data}</strong>`;
                elemento.appendChild(botao);
    
                const listaDeTarefas = document.getElementById("lista-de-tarefas");
                listaDeTarefas.appendChild(elemento);
            });
        }
    
        function removerTarefa(evento) {
            const botao = evento.target;
            const id = botao.id;
            afazeres = afazeres.filter(function(tarefa) {
                return tarefa.id != id;
            });
            renderizar();
            salvarTarefas();
        }
    
        renderizar(); -->
    </script>
    <!-- <script>
        document.addEventListener('DOMContentLoaded', function() {  // Espera até que o conteúdo da página esteja completamente carregado
        const form = document.getElementById('agenda-form');  // Obtém o elemento do formulário pelo ID
        const taskInput = document.getElementById('task-input');  // Obtém o campo de input para o texto da tarefa pelo ID
        const taskDay = document.getElementById('task-day');  // Obtém o campo de input para o dia da tarefa pelo ID
        const taskMonth = document.getElementById('task-month');  // Obtém o campo de input para o mês da tarefa pelo ID
        const taskYear = document.getElementById('task-year');  // Obtém o campo de input para o ano da tarefa pelo ID
        const taskList = document.getElementById('agenda-list');  // Obtém a lista onde as tarefas serão exibidas pelo ID

        // Carregar tarefas do localStorage, se existirem. Caso contrário, inicializa um array vazio.
        const tasks = JSON.parse(localStorage.getItem('tasks')) || [];  // Recupera as tarefas do localStorage ou define um array vazio

        function renderTasks() {  // Função para renderizar as tarefas na tela
            taskList.innerHTML = '';  // Limpa a lista de tarefas antes de renderizar novamente
            tasks.forEach((task, index) => {  // Para cada tarefa no array tasks
                const li = document.createElement('li');  // Cria um novo item de lista (<li>)
                li.textContent = `${task.text} - ${task.day}/${task.month}/${task.year}`;  // Define o texto do item da lista (tarefa e data)
                if (task.completed) {  // Se a tarefa está marcada como concluída
                    li.classList.add('completed');  // Adiciona a classe 'completed' para estilizar a tarefa como concluída
                }
                li.classList.add('animate__animated', 'animate__fadeIn');  // Adiciona classes de animação para que a tarefa apareça suavemente

                const completeButton = document.createElement('button');  // Cria um botão para concluir a tarefa
                completeButton.textContent = 'Concluir';  // Define o texto do botão como 'Concluir'
                completeButton.classList.add('complete');  // Adiciona uma classe de estilo para o botão
                completeButton.addEventListener('click', () => {  // Adiciona um evento de clique no botão
                    task.completed = !task.completed;  // Alterna o estado de conclusão da tarefa
                    localStorage.setItem('tasks', JSON.stringify(tasks));  // Salva as tarefas atualizadas no localStorage
                    renderTasks();  // Re-renderiza as tarefas para refletir a mudança de estado
                });

                const removeButton = document.createElement('button');  // Cria um botão para remover a tarefa
                removeButton.textContent = 'Remover';  // Define o texto do botão como 'Remover'
                removeButton.addEventListener('click', () => {  // Adiciona um evento de clique no botão
                    li.classList.add('animate__animated', 'animate__fadeOutRight');  // Adiciona uma animação de fade-out para remover a tarefa
                    setTimeout(() => {  // Aguarda a animação de remoção terminar
                        tasks.splice(index, 1);  // Remove a tarefa do array de tarefas pelo índice
                        localStorage.setItem('tasks', JSON.stringify(tasks));  // Atualiza o localStorage com as tarefas restantes
                        renderTasks();  // Re-renderiza as tarefas para refletir a remoção
                    }, 1000);  // Define o tempo da animação (1000ms = 1 segundo)
                });

                const buttonsDiv = document.createElement('div');  // Cria uma <div> para conter os botões de ação
                buttonsDiv.classList.add('buttons');  // Adiciona uma classe de estilo para os botões
                buttonsDiv.appendChild(completeButton);  // Adiciona o botão "Concluir" à div
                buttonsDiv.appendChild(removeButton);  // Adiciona o botão "Remover" à div

                li.appendChild(buttonsDiv);  // Adiciona a div com os botões ao item da lista
                taskList.appendChild(li);  // Adiciona o item da lista à lista de tarefas na página
            });
        }

        form.addEventListener('submit', function(event) {  // Adiciona um evento de envio de formulário
            event.preventDefault();  // Impede que a página seja recarregada ao enviar o formulário
            const taskText = taskInput.value.trim();  // Obtém o texto da tarefa, removendo espaços extras
            const taskDayValue = taskDay.value.trim();  // Obtém o valor do dia da tarefa
            const taskMonthValue = taskMonth.value.trim();  // Obtém o valor do mês da tarefa
            const taskYearValue = taskYear.value.trim();  // Obtém o valor do ano da tarefa
            if (taskText && taskDayValue && taskMonthValue && taskYearValue) {  // Verifica se todos os campos estão preenchidos
                tasks.push({  // Adiciona a nova tarefa ao array de tarefas
                    text: taskText,  // Define o texto da tarefa
                    day: taskDayValue,  // Define o dia da tarefa
                    month: taskMonthValue,  // Define o mês da tarefa
                    year: taskYearValue,  // Define o ano da tarefa
                    completed: false  // Define que a tarefa começa como não concluída
                });
                localStorage.setItem('tasks', JSON.stringify(tasks));  // Salva as tarefas no localStorage
                renderTasks();  // Re-renderiza a lista de tarefas
                taskInput.value = '';  // Limpa o campo de entrada de texto
                taskDay.value = '';  // Limpa o campo de entrada do dia
                taskMonth.value = '';  // Limpa o campo de entrada do mês
                taskYear.value = '';  // Limpa o campo de entrada do ano
            }
        });

        renderTasks();  // Chama a função para renderizar as tarefas quando a página é carregada
    });
    </script> -->
</body>
</html>
 